{"ast":null,"code":"var cheerio = require(\"cheerio\");\n\nexport function convertWileyBook(content) {\n  // the book is wiley\n  var $ = cheerio.load(content);\n\n  function wrapHtmlTag(item, wrapWith) {\n    $(item).wrap(wrapWith).html();\n  }\n\n  function wrapHtmlPrent(item, wrapWith) {\n    $(item).parent().wrap(wrapWith).html();\n  }\n\n  function removeWrap(item) {\n    $(item).each(function () {\n      $(this).replaceWith($(this).html());\n    });\n  } // Change <b> tags to <strong>\n\n\n  $(\"b\").each(function (i, item) {\n    return item.tagName = \"strong\";\n  });\n  $(\"span.bold\").each(function (i, item) {\n    return item.tagName = \"strong\";\n  }); // Change <i> tags to <em>\n\n  $(\"i\").each(function (i, item) {\n    return item.tagName = \"em\";\n  });\n  $(\"span.italic\").each(function (i, item) {\n    return item.tagName = \"em\";\n  }); //update book headers\n\n  $(\"p.h1\").each(function (i, item) {\n    return item.tagName = \"h1\";\n  });\n  $(\"p.h2\").each(function (i, item) {\n    return item.tagName = \"h2\";\n  });\n  $(\"p.h\").each(function (i, item) {\n    return item.tagName = \"h3\";\n  }); //update add blockquotes\n\n  wrapHtmlTag(\"div.note\", \"<blockquote></blockquote>\");\n  wrapHtmlTag(\"div.list1\", \"<blockquote></blockquote>\");\n  wrapHtmlTag(\".authorgroup\", \"<blockquote></blockquote>\"); // remove link in span.codelabel\n\n  removeWrap(\"figcaption a\"); // remove figure.floatcenter\n\n  removeWrap(\"figure.floatcenter\"); // remove figure.floatcenter\n\n  removeWrap(\"div.figure\"); // change span.codelabel to kbd\n\n  $(\"span.codelabel\").each(function (i, item) {\n    return item.tagName = \"kbd\";\n  }); // todo:code not yet working\n\n  /* \n  $(\"aside[type='sidebar']\").each((i, item) => (item.tagName = \"blockquote\"));\n  removeWrap(\"section .toclist\"); */\n\n  $(\"*\").removeAttr(\"class\").html();\n  $(\"*\").removeAttr(\"id\").html();\n  $(\"*\").removeAttr(\"title\").html();\n  removeWrap(\"a[href*='#calibre_link-']\");\n  removeWrap(\"article\");\n  removeWrap(\"aside\");\n  removeWrap(\"header\");\n  removeWrap(\"section\");\n  removeWrap(\"span\");\n  removeWrap(\"p span\");\n  removeWrap(\"figure\");\n  removeWrap(\"hr\");\n  removeWrap(\"div\"); //! issue: removes all images\n  //! $(\"*\").each(function(index, item) {\n  //!   if ($(item).text() === \"\") {\n  //!     $(item).remove();\n  //!   }\n  //! });\n\n  $(\"*\").find(\"section\").each(function () {\n    $(this).replaceWith($(this).html());\n  }); // Clean up <pre> tag from br and strong tags\n\n  removeWrap(\"pre span\");\n  removeWrap(\"pre strong\");\n  $(\"code br\").each(function () {\n    $(this).replaceWith(\"\\n\");\n  });\n  $(\"pre br\").each(function () {\n    $(this).replaceWith(\"\\n\");\n  }); // Add p tag to all images with image-wrapper class\n\n  var imgStyle = $('<p class=\"image-wrapper\"></p>');\n  $(\"img\").wrap(imgStyle); // Update image class to lazyload\n\n  $(\"img\").removeClass().html();\n  $(\"img\").addClass(\"lazyload\"); // add f-center to figcation p\n\n  $(\"figcaption p\").addClass(\"f-center\"); // remove figcaption\n\n  removeWrap(\"figcaption\"); // Remove <b> inside <pre> tags\n\n  removeWrap(\"pre b\"); // Remove <strong> inside <pre> tags\n\n  removeWrap(\"pre strong\"); // Remove <code> inside <pre> tags\n\n  removeWrap(\"pre code\"); // convert code for a while\n\n  $(\"p code\").each(function (i, item) {\n    return item.tagName = \"kbd\";\n  });\n  $(\"li code\").each(function (i, item) {\n    return item.tagName = \"kbd\";\n  });\n  $(\"p pre\").each(function (i, item) {\n    return item.tagName = \"kbd\";\n  }); // Add code tag to all pre tags\n\n  var addPre = $(\"<pre></pre>\");\n  $(\"pre\").each(function (i, item) {\n    return item.tagName = \"code\";\n  });\n  $(\"code\").wrap(addPre); // convert kbd back to code\n\n  $(\"p kbd\").each(function (i, item) {\n    return item.tagName = \"code\";\n  });\n  $(\"li kbd\").each(function (i, item) {\n    return item.tagName = \"code\";\n  });\n  var cleanHTML = $.html();\n  return cleanHTML;\n}","map":{"version":3,"sources":["/Users/sitepoint/Sitepoint_tool/Book-Building-Tool/src/helper/wiley.js"],"names":["cheerio","require","convertWileyBook","content","$","load","wrapHtmlTag","item","wrapWith","wrap","html","wrapHtmlPrent","parent","removeWrap","each","replaceWith","i","tagName","removeAttr","find","imgStyle","removeClass","addClass","addPre","cleanHTML"],"mappings":"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","sourcesContent":["const cheerio = require(\"cheerio\");\n\nexport function convertWileyBook(content) {\n  // the book is wiley\n  const $ = cheerio.load(content);\n\n  function wrapHtmlTag(item, wrapWith) {\n    $(item)\n      .wrap(wrapWith)\n      .html();\n  }\n\n  function wrapHtmlPrent(item, wrapWith) {\n    $(item)\n      .parent()\n      .wrap(wrapWith)\n      .html();\n  }\n\n  function removeWrap(item) {\n    $(item).each(function() {\n      $(this).replaceWith($(this).html());\n    });\n  }\n\n  // Change <b> tags to <strong>\n\n  $(\"b\").each((i, item) => (item.tagName = \"strong\"));\n  $(\"span.bold\").each((i, item) => (item.tagName = \"strong\"));\n  // Change <i> tags to <em>\n\n  $(\"i\").each((i, item) => (item.tagName = \"em\"));\n  $(\"span.italic\").each((i, item) => (item.tagName = \"em\"));\n\n  //update book headers\n\n  $(\"p.h1\").each((i, item) => (item.tagName = \"h1\"));\n  $(\"p.h2\").each((i, item) => (item.tagName = \"h2\"));\n  $(\"p.h\").each((i, item) => (item.tagName = \"h3\"));\n\n  //update add blockquotes\n\n  wrapHtmlTag(\"div.note\", \"<blockquote></blockquote>\");\n  wrapHtmlTag(\"div.list1\", \"<blockquote></blockquote>\");\n  wrapHtmlTag(\".authorgroup\", \"<blockquote></blockquote>\");\n\n  // remove link in span.codelabel\n\n  removeWrap(\"figcaption a\");\n\n  // remove figure.floatcenter\n  removeWrap(\"figure.floatcenter\");\n\n  // remove figure.floatcenter\n  removeWrap(\"div.figure\");\n\n  // change span.codelabel to kbd\n  $(\"span.codelabel\").each((i, item) => (item.tagName = \"kbd\"));\n\n  // todo:code not yet working\n  /* \n  $(\"aside[type='sidebar']\").each((i, item) => (item.tagName = \"blockquote\"));\n  removeWrap(\"section .toclist\"); */\n\n  $(\"*\")\n    .removeAttr(\"class\")\n    .html();\n\n  $(\"*\")\n    .removeAttr(\"id\")\n    .html();\n\n  $(\"*\")\n    .removeAttr(\"title\")\n    .html();\n\n  removeWrap(\"a[href*='#calibre_link-']\");\n  removeWrap(\"article\");\n  removeWrap(\"aside\");\n  removeWrap(\"header\");\n  removeWrap(\"section\");\n  removeWrap(\"span\");\n  removeWrap(\"p span\");\n  removeWrap(\"figure\");\n  removeWrap(\"hr\");\n  removeWrap(\"div\");\n\n  //! issue: removes all images\n  //! $(\"*\").each(function(index, item) {\n  //!   if ($(item).text() === \"\") {\n  //!     $(item).remove();\n  //!   }\n  //! });\n\n  $(\"*\")\n    .find(\"section\")\n    .each(function() {\n      $(this).replaceWith($(this).html());\n    });\n\n  // Clean up <pre> tag from br and strong tags\n\n  removeWrap(\"pre span\");\n\n  removeWrap(\"pre strong\");\n\n  $(\"code br\").each(function() {\n    $(this).replaceWith(\"\\n\");\n  });\n\n  $(\"pre br\").each(function() {\n    $(this).replaceWith(\"\\n\");\n  });\n\n  // Add p tag to all images with image-wrapper class\n\n  const imgStyle = $('<p class=\"image-wrapper\"></p>');\n  $(\"img\").wrap(imgStyle);\n\n  // Update image class to lazyload\n\n  $(\"img\")\n    .removeClass()\n    .html();\n\n  $(\"img\").addClass(\"lazyload\");\n\n  // add f-center to figcation p\n  $(\"figcaption p\").addClass(\"f-center\");\n\n  // remove figcaption\n  removeWrap(\"figcaption\");\n\n  // Remove <b> inside <pre> tags\n  removeWrap(\"pre b\");\n\n  // Remove <strong> inside <pre> tags\n  removeWrap(\"pre strong\");\n\n  // Remove <code> inside <pre> tags\n  removeWrap(\"pre code\");\n\n  // convert code for a while\n\n  $(\"p code\").each((i, item) => (item.tagName = \"kbd\"));\n  $(\"li code\").each((i, item) => (item.tagName = \"kbd\"));\n  $(\"p pre\").each((i, item) => (item.tagName = \"kbd\"));\n\n  // Add code tag to all pre tags\n\n  const addPre = $(\"<pre></pre>\");\n\n  $(\"pre\").each((i, item) => (item.tagName = \"code\"));\n  $(\"code\").wrap(addPre);\n\n  // convert kbd back to code\n\n  $(\"p kbd\").each((i, item) => (item.tagName = \"code\"));\n  $(\"li kbd\").each((i, item) => (item.tagName = \"code\"));\n\n  const cleanHTML = $.html();\n\n  return cleanHTML;\n}\n"]},"metadata":{},"sourceType":"module"}