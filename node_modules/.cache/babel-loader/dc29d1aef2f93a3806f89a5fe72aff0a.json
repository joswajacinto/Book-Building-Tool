{"ast":null,"code":"var cheerio = require(\"cheerio\");\n\nexport function convertPacktBook(content) {\n  var $ = cheerio.load(content);\n\n  function wrapHtmlTag(item, wrapWith) {\n    $(item).wrap(wrapWith).html();\n  }\n\n  function wrapHtmlPrent(item, wrapWith) {\n    $(item).parent().wrap(wrapWith).html();\n  }\n\n  function removeWrap(item) {\n    $(item).each(function () {\n      $(this).replaceWith($(this).html());\n    });\n  } // look for .packt_tip and wrap it with <tip> as placeholder\n\n\n  wrapHtmlTag(\"div[class*='packt_tip']\", \"<tipplaceholder1></tipplaceholder1>\");\n  removeWrap(\"div[class*='packt_tip'] p\");\n  $(\"div[class*='packt_tip']\").each(function (i, item) {\n    return item.tagName = \"p\";\n  });\n  wrapHtmlTag(\"p.packt_tip\", \"<tipplaceholder2></tipplaceholder2>\"); // look for .infobox and wrap it with <note>\n\n  wrapHtmlTag(\".packt_infobox\", \"<noteplaceholder1></noteplaceholder1>\");\n  removeWrap(\"div.packt_infobox p\");\n  $(\"div.packt_infobox\").each(function (i, item) {\n    return item.tagName = \"p\";\n  });\n  wrapHtmlTag(\"p.packt_infobox\", \"<noteplaceholder2></noteplaceholder2>\"); // look for .packt_quote\n\n  wrapHtmlTag(\".packt_quote\", \"<blockquote></blockquote>\");\n  $(\"blockquote div\").each(function (i, item) {\n    return item.tagName = \"p\";\n  }); // Update packt_figref to <p> wiht f-center class\n\n  wrapHtmlTag(\".packt_figref\", \"<centerText></centerText>\");\n  wrapHtmlTag(\".cdpaligncenter1\", \"<centerText></centerText>\");\n  removeWrap(\"div.cdpaligncenter1\"); // remove div inside the <img >\n\n  $(\"div .cdpaligncenter\").each(function (i, item) {\n    return item.tagName = \"p\";\n  }); // $(\"div .packt_figure1\").each((i, item) => (item.tagName = \"p\"));\n  // Remove unnecessary html elements for the books\n\n  $(\"*\").removeAttr(\"class\").html();\n  $(\"*\").removeAttr(\"id\").html();\n  $(\"*\").removeAttr(\"title\").html();\n  removeWrap(\"a[href*='#calibre']\");\n  removeWrap(\"div\");\n  removeWrap(\"article\");\n  removeWrap(\"aside\");\n  removeWrap(\"header\");\n  removeWrap(\"section\");\n  removeWrap(\"span\");\n  removeWrap(\"p span\"); //! issue: removes all images\n  //! $(\"*\").each(function(index, item) {\n  //!   if ($(item).text() === \"\") {\n  //!    $(item).remove();\n  //!   }\n  //! });\n  // Remove <span> and <strong> inside <pre>\n\n  removeWrap(\"pre span\");\n  removeWrap(\"pre strong\"); // Replace <br> to actual lines inside <pre>\n\n  $(\"code br\").each(function () {\n    $(this).replaceWith(\"\\n\");\n  });\n  $(\"pre br\").each(function () {\n    $(this).replaceWith(\"\\n\");\n  }); // Add <p class=\"image-wrapper\"> to all images\n\n  var imgStyle = $('<p class=\"image-wrapper\"></p>');\n  $(\"img\").wrap(imgStyle); // Add class of \"lazyload\" to <img>\n\n  $(\"img\").removeClass().html();\n  $(\"img\").addClass(\"lazyload\"); // Add <code> inside <pre>\n\n  var addPre = $(\"<pre></pre>\");\n  $(\"pre\").each(function (i, item) {\n    return item.tagName = \"code\";\n  });\n  $(\"code\").wrap(addPre); // Add styling to tip\n\n  var addTipClass = $(\"<div class='box tip'></div>\");\n  wrapHtmlTag(\"tipplaceholder1 p\", \"<div class='body'></div>\");\n  wrapHtmlTag(\"tipplaceholder1\", addTipClass);\n  $(\"tipplaceholder1\").prepend(\"<h4>Tip</h4>\"); // remove placeholder for tip\n\n  removeWrap(\"tipplaceholder1\");\n  removeWrap(\"tipplaceholder2\"); // Add note styling to note\n\n  var addNoteClass = $(\"<div class='box note'></div>\");\n  wrapHtmlTag(\"noteplaceholder1 p\", \"<div class='body'></div>\");\n  wrapHtmlTag(\"noteplaceholder1\", addNoteClass);\n  $(\"noteplaceholder1\").prepend(\"<h4>Note</h4>\"); // remove placeholder for notes\n\n  removeWrap(\"noteplaceholder2\");\n  removeWrap(\"noteplaceholder1\"); // convert <centertext> to <p class=\"f-center\">\n\n  $(\"centertext\").addClass(\"f-center\");\n  $(\"centertext\").each(function (i, item) {\n    return item.tagName = \"p\";\n  });\n  var cleanHTML = $.html();\n  return cleanHTML;\n}","map":{"version":3,"sources":["/Users/sitepoint/Sitepoint_tool/Book-Building-Tool/src/helper/packt.js"],"names":["cheerio","require","convertPacktBook","content","$","load","wrapHtmlTag","item","wrapWith","wrap","html","wrapHtmlPrent","parent","removeWrap","each","replaceWith","i","tagName","removeAttr","imgStyle","removeClass","addClass","addPre","addTipClass","prepend","addNoteClass","cleanHTML"],"mappings":"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","sourcesContent":["const cheerio = require(\"cheerio\");\n\nexport function convertPacktBook(content) {\n  const $ = cheerio.load(content);\n\n  function wrapHtmlTag(item, wrapWith) {\n    $(item)\n      .wrap(wrapWith)\n      .html();\n  }\n\n  function wrapHtmlPrent(item, wrapWith) {\n    $(item)\n      .parent()\n      .wrap(wrapWith)\n      .html();\n  }\n\n  function removeWrap(item) {\n    $(item).each(function() {\n      $(this).replaceWith($(this).html());\n    });\n  }\n\n  // look for .packt_tip and wrap it with <tip> as placeholder\n\n  wrapHtmlTag(\"div[class*='packt_tip']\", \"<tipplaceholder1></tipplaceholder1>\");\n\n  removeWrap(\"div[class*='packt_tip'] p\");\n  $(\"div[class*='packt_tip']\").each((i, item) => (item.tagName = \"p\"));\n\n  wrapHtmlTag(\"p.packt_tip\", \"<tipplaceholder2></tipplaceholder2>\");\n\n  // look for .infobox and wrap it with <note>\n\n  wrapHtmlTag(\".packt_infobox\", \"<noteplaceholder1></noteplaceholder1>\");\n\n  removeWrap(\"div.packt_infobox p\");\n  $(\"div.packt_infobox\").each((i, item) => (item.tagName = \"p\"));\n\n  wrapHtmlTag(\"p.packt_infobox\", \"<noteplaceholder2></noteplaceholder2>\");\n\n  // look for .packt_quote\n\n  wrapHtmlTag(\".packt_quote\", \"<blockquote></blockquote>\");\n\n  $(\"blockquote div\").each((i, item) => (item.tagName = \"p\"));\n\n  // Update packt_figref to <p> wiht f-center class\n\n  wrapHtmlTag(\".packt_figref\", \"<centerText></centerText>\");\n\n  wrapHtmlTag(\".cdpaligncenter1\", \"<centerText></centerText>\");\n\n  removeWrap(\"div.cdpaligncenter1\");\n  // remove div inside the <img >\n\n  $(\"div .cdpaligncenter\").each((i, item) => (item.tagName = \"p\"));\n\n  // $(\"div .packt_figure1\").each((i, item) => (item.tagName = \"p\"));\n\n  // Remove unnecessary html elements for the books\n\n  $(\"*\")\n    .removeAttr(\"class\")\n    .html();\n\n  $(\"*\")\n    .removeAttr(\"id\")\n    .html();\n\n  $(\"*\")\n    .removeAttr(\"title\")\n    .html();\n\n  removeWrap(\"a[href*='#calibre']\");\n\n  removeWrap(\"div\");\n  removeWrap(\"article\");\n  removeWrap(\"aside\");\n  removeWrap(\"header\");\n  removeWrap(\"section\");\n  removeWrap(\"span\");\n  removeWrap(\"p span\");\n\n  //! issue: removes all images\n  //! $(\"*\").each(function(index, item) {\n  //!   if ($(item).text() === \"\") {\n  //!    $(item).remove();\n  //!   }\n  //! });\n\n  // Remove <span> and <strong> inside <pre>\n\n  removeWrap(\"pre span\");\n\n  removeWrap(\"pre strong\");\n\n  // Replace <br> to actual lines inside <pre>\n\n  $(\"code br\").each(function() {\n    $(this).replaceWith(\"\\n\");\n  });\n\n  $(\"pre br\").each(function() {\n    $(this).replaceWith(\"\\n\");\n  });\n\n  // Add <p class=\"image-wrapper\"> to all images\n\n  const imgStyle = $('<p class=\"image-wrapper\"></p>');\n  $(\"img\").wrap(imgStyle);\n\n  // Add class of \"lazyload\" to <img>\n\n  $(\"img\")\n    .removeClass()\n    .html();\n\n  $(\"img\").addClass(\"lazyload\");\n\n  // Add <code> inside <pre>\n\n  const addPre = $(\"<pre></pre>\");\n\n  $(\"pre\").each((i, item) => (item.tagName = \"code\"));\n  $(\"code\").wrap(addPre);\n\n  // Add styling to tip\n\n  const addTipClass = $(\"<div class='box tip'></div>\");\n\n  wrapHtmlTag(\"tipplaceholder1 p\", \"<div class='body'></div>\");\n  wrapHtmlTag(\"tipplaceholder1\", addTipClass);\n  $(\"tipplaceholder1\").prepend(\"<h4>Tip</h4>\");\n\n  // remove placeholder for tip\n  removeWrap(\"tipplaceholder1\");\n  removeWrap(\"tipplaceholder2\");\n\n  // Add note styling to note\n  const addNoteClass = $(\"<div class='box note'></div>\");\n\n  wrapHtmlTag(\"noteplaceholder1 p\", \"<div class='body'></div>\");\n  wrapHtmlTag(\"noteplaceholder1\", addNoteClass);\n  $(\"noteplaceholder1\").prepend(\"<h4>Note</h4>\");\n\n  // remove placeholder for notes\n  removeWrap(\"noteplaceholder2\");\n  removeWrap(\"noteplaceholder1\");\n\n  // convert <centertext> to <p class=\"f-center\">\n  $(\"centertext\").addClass(\"f-center\");\n  $(\"centertext\").each((i, item) => (item.tagName = \"p\"));\n\n  const cleanHTML = $.html();\n\n  return cleanHTML;\n}\n"]},"metadata":{},"sourceType":"module"}